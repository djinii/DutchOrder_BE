"use strict";(self["webpackChunkv2_client"]=self["webpackChunkv2_client"]||[]).push([[390],{7390:function(t,s,e){e.r(s),e.d(s,{default:function(){return mt}});var a=e(6768),o=e(4232);const r={class:"nav nav-tabs",id:"nav-tab",role:"tablist"},n=["id","data-bs-target","aria-controls","aria-selected","onClick"],i={class:"tab-content",id:"nav-tabContent"},u=["id","aria-labelledby"],d={class:"container"},l={class:"row"};function c(t,s,e,c,m,b){const k=(0,a.g2)("router-link"),h=(0,a.g2)("B_Ordcard"),p=(0,a.g2)("B_OrdSpecCard"),v=(0,a.g2)("B_ShopStatus");return(0,a.uX)(),(0,a.CE)("div",null,[(0,a.Lk)("div",r,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(m.tabs,((t,s)=>((0,a.uX)(),(0,a.CE)("button",{key:s,class:(0,o.C4)({"nav-link":!0,active:s===m.activeTabIndex}),id:"nav-"+t.id+"-tab","data-bs-toggle":"tab","data-bs-target":"#nav-"+t.id,type:"button",role:"tab","aria-controls":"nav-"+t.id,"aria-selected":s===m.activeTabIndex,onClick:t=>b.changeTab(s)},[(0,a.bF)(k,{to:{path:"/business/B_Ordering",query:{status:t.status}}},{default:(0,a.k6)((()=>[(0,a.eW)((0,o.v_)(t.name),1)])),_:2},1032,["to"])],10,n)))),128))]),(0,a.Lk)("div",i,[((0,a.uX)(),(0,a.Wv)(a.PR,null,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(m.tabs,((t,s)=>((0,a.uX)(),(0,a.CE)("div",{key:s,id:"nav-"+t.id,class:(0,o.C4)(["tab-pane fade",{"show active":s===m.activeTabIndex}]),role:"tabpanel","aria-labelledby":"nav-"+t.id+"-tab"},[(0,a.Lk)("div",d,[(0,a.Lk)("div",l,["home"===t.id?((0,a.uX)(),(0,a.Wv)(h,{key:0,bnum:m.bnum},null,8,["bnum"])):((0,a.uX)(),(0,a.Wv)(p,{key:1,bnum:m.bnum,orderStatus:t.orderStatus},null,8,["bnum","orderStatus"]))])])],10,u)))),128))],1024)),(0,a.bF)(v,{bnum:m.bnum},null,8,["bnum"])])])}const m={class:"container",style:{"overflow-y":"auto"}},b={class:"row"},k={class:"card p-3"},h=(0,a.Lk)("h5",{class:"card-title"},"이미지",-1),p={class:"list-group list-group-flush"},v={class:"list-group-item"},y={class:"list-group-item"},L={class:"list-group-item"},_={class:"button-group mt-3"},g=["onClick"],C=["onClick"],f=["onClick"],S=["onClick"];function O(t,s,e,r,n,i){const u=(0,a.g2)("MS_B_OrderDetailModal");return(0,a.uX)(),(0,a.CE)("div",m,[(0,a.Lk)("div",b,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(i.uniqueOrders,((t,e)=>((0,a.uX)(),(0,a.CE)("div",{key:e,class:"col-3 mb-3"},[(0,a.Lk)("div",k,[h,(0,a.Lk)("ul",p,[(0,a.Lk)("li",v," 주문일시: "+(0,o.v_)(i.formatDate(t.odate)),1),(0,a.Lk)("li",y,"주문번호: "+(0,o.v_)(t.osnum),1),(0,a.Lk)("li",L,"사업자번호: "+(0,o.v_)(t.bnum),1)]),(0,a.Lk)("div",_,[802===t.ostatus_mikey?((0,a.uX)(),(0,a.CE)("button",{key:0,onClick:s=>i.setOstatusMikey(t),class:"btn btn-primary"}," 확인 ",8,g)):(0,a.Q3)("",!0),803===t.ostatus_mikey?((0,a.uX)(),(0,a.CE)("button",{key:1,onClick:s=>i.setOstatusMikey(t),class:"btn btn-success"}," 조리중 ",8,C)):(0,a.Q3)("",!0),804===t.ostatus_mikey?((0,a.uX)(),(0,a.CE)("button",{key:2,onClick:s=>i.setOstatusMikey(t),class:"btn btn-warning"}," 배달시작 ",8,f)):(0,a.Q3)("",!0),805===t.ostatus_mikey?((0,a.uX)(),(0,a.CE)("button",{key:3,onClick:s=>i.setOstatusMikey(t),class:"btn btn-info"}," 배달완료 ",8,S)):(0,a.Q3)("",!0),(0,a.Lk)("button",{type:"button",class:"btn btn-secondary",onClick:s[0]||(s[0]=t=>n.showOrderDetailModal=!0)}," 상세보기 ")]),n.showOrderDetailModal?((0,a.uX)(),(0,a.Wv)(u,{key:0,onClose:s[1]||(s[1]=t=>n.showOrderDetailModal=!1)})):(0,a.Q3)("",!0)])])))),128))])])}var w=e(8355);const E={class:"modal",tabindex:"-1",role:"dialog",id:"orderDetailModal"},X={class:"modal-dialog",role:"document"},M={class:"modal-content"},D=(0,a.Lk)("div",{class:"modal-header"},[(0,a.Lk)("h5",{class:"modal-title"},"주문 상세 정보"),(0,a.Lk)("button",{type:"button",class:"close","data-dismiss":"modal","aria-label":"Close"},[(0,a.Lk)("span",{"aria-hidden":"true"},"×")])],-1),B={class:"modal-body"},I={class:"modal-footer"},A={class:"modal-footer"};function x(t,s,e,r,n,i){return(0,a.uX)(),(0,a.CE)("div",E,[(0,a.Lk)("div",X,[(0,a.Lk)("div",M,[D,(0,a.Lk)("div",B,[(0,a.Lk)("p",null,"전화번호: "+(0,o.v_)(e.order.phone),1),(0,a.Lk)("p",null,"주소: "+(0,o.v_)(e.order.address),1),(0,a.Lk)("p",null,"메뉴: "+(0,o.v_)(e.order.menu),1),(0,a.Lk)("p",null,"가격: "+(0,o.v_)(e.order.price),1)]),(0,a.Lk)("div",I,[(0,a.Lk)("div",A,[(0,a.Lk)("button",{type:"button",class:"btn btn-secondary","data-dismiss":"modal",onClick:s[0]||(s[0]=t=>n.showModal=!1)}," 닫기 ")])])])])])}var Q={name:"MS_B_OrderDetailModal",props:["order"],data(){return{showModal:!1}},methods:{openModal(){this.showModal=!0}}},q=e(1241);const T=(0,q.A)(Q,[["render",x]]);var R=T,F={name:"B_OrdSpecCard",props:["orderStatus","bnum"],components:{MS_B_OrderDetailModal:R},data(){return{orderList:[],showOrderDetailModal:!1}},mounted(){this.fetchOrderList()},computed:{uniqueOrders(){const t={};return this.filteredOrders.forEach((s=>{t[s.osnum]||(t[s.osnum]=s)})),Object.values(t)},filteredOrders(){return this.orderStatus&&0!==this.orderStatus.length?this.orderList.filter((t=>t.ostatus_mikey===this.orderStatus&&t.bnum===this.bnum)):[]}},methods:{formatDate(t){const s=new Date(t);return s.toLocaleString()},openModal(){this.showOrderDetailModal=!0},async fetchOrderList(){try{const t=await w.A.get("/business/B_Ordering");this.orderList=t.data.sort(((t,s)=>new Date(s.odate)-new Date(t.odate))),console.log("Response:",t.data)}catch(t){console.error("Error fetching orderList:",t)}},async setOstatusMikey(t){try{let s;s=803===t.ostatus_mikey?804:804===t.ostatus_mikey?805:803;const e=await w.A.post("/OrderStatusUpdate",{ostatus_mikey:s,bnum:t.bnum,onum:t.onum});console.log("Response:",e.data),this.$router.go("/business/B_Ordering"),this.fetchOrderList()}catch(s){console.error("Error updating ostatus_mikey:",s)}}}};const W=(0,q.A)(F,[["render",O]]);var K=W;const $={class:"container",style:{"overflow-y":"auto"}},N={class:"row"},P={key:0,class:"card mt-3",style:{width:"18rem"}},U=(0,a.Lk)("h5",{class:"card-title"},"이미지",-1),j={class:"card-body"},z={class:"card",style:{width:"16rem"}},G={class:"list-group list-group-flush"},H={class:"list-group-item"},J={class:"list-group-item"},V={class:"list-group-item"},Y=(0,a.Lk)("p",null,null,-1),Z=(0,a.Lk)("button",{type:"button"},"상세보기",-1);function tt(t,s,e,r,n,i){return(0,a.uX)(),(0,a.CE)("div",$,[(0,a.Lk)("div",N,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(i.uniqueOrders,((t,s)=>((0,a.uX)(),(0,a.CE)("div",{key:s,class:"col-3 mb-3"},[t.bnum===e.bnum?((0,a.uX)(),(0,a.CE)("div",P,[U,(0,a.Lk)("div",j,[(0,a.Lk)("div",z,[(0,a.Lk)("ul",G,[(0,a.Lk)("li",H," 주문일시: "+(0,o.v_)(i.formatDate(t.odate)),1),(0,a.Lk)("li",J,"주문번호: "+(0,o.v_)(t.osnum),1),(0,a.Lk)("li",V,"사업자번호: "+(0,o.v_)(t.bnum),1)])]),Y,Z])])):(0,a.Q3)("",!0)])))),128))])])}var st={name:"B_Ordcard",components:{},props:{bnum:{type:Number,required:!0}},data(){return{orderList:[]}},mounted(){this.fetchOrderList()},computed:{uniqueOrders(){return this.orderList.filter((t=>t.bnum===this.bnum))}},methods:{formatDate(t){const s=new Date(t);return s.toLocaleString()},async fetchOrderList(){try{const t=await w.A.get("/business/B_Ordering");this.orderList=t.data.sort(((t,s)=>new Date(s.odate)-new Date(t.odate))),console.log("Response:",t.data)}catch(t){console.error("Error fetching orderList:",t)}}}};const et=(0,q.A)(st,[["render",tt]]);var at=et;const ot={style:{position:"absolute",top:"10px",right:"10px"}},rt={key:2,class:"alert alert-warning",role:"alert"};function nt(t,s,e,o,r,n){return(0,a.uX)(),(0,a.CE)("div",ot,[401===r.sstatus_mikey?((0,a.uX)(),(0,a.CE)("button",{key:0,onClick:s[0]||(s[0]=t=>n.confirmShopClosure(402,"영업을 종료하시겠습니까?")),class:"status-button"}," 운영종료하기 ")):(0,a.Q3)("",!0),402===r.sstatus_mikey?((0,a.uX)(),(0,a.CE)("button",{key:1,onClick:s[1]||(s[1]=t=>n.confirmShopClosure(401,"영업을 시작하시겠습니까?")),class:"status-button"}," 운영시작하기 ")):(0,a.Q3)("",!0),402===r.sstatus_mikey?((0,a.uX)(),(0,a.CE)("div",rt," 영업이 중지되었습니다. ")):(0,a.Q3)("",!0)])}var it={name:"B_ShopStatus",props:["bnum"],data(){return{sstatus_mikey:null}},created(){this.fetchShopStatus()},methods:{async fetchShopStatus(){try{console.log("bnum:",this.bnum);const t=await w.A.post("/ShopStatus",{bnum:this.bnum});this.sstatus_mikey=t.data.sstatus_mikey,console.log("Shop Status Response:",t.data)}catch(t){console.error("운영 상태 값을 가져오는 중 오류 발생:",t)}},async confirmShopClosure(t,s){if(confirm(s)){console.log("새로운 상태:",t);try{const s=await w.A.post("/ShopStatusUpdate",{sstatus_mikey:t,bnum:this.bnum}),e=s.data.sstatus_mikey;console.log("setStatusMikey Response:",e),this.fetchShopStatus()}catch(e){console.error("운영 상태 값을 업데이트하는 중 오류 발생:",e)}}}}};const ut=(0,q.A)(it,[["render",nt],["__scopeId","data-v-1d62d7e4"]]);var dt=ut,lt={name:"B_Ordering",components:{B_OrdSpecCard:K,B_Ordcard:at,B_ShopStatus:dt},data(){return{tabs:[{id:"home",name:"전체",orderStatus:800,status:800},{id:"OrderReady",name:"주문수락대기",orderStatus:802,status:802},{id:"Preparing",name:"조리중",orderStatus:803,status:803},{id:"Start",name:"배달시작",orderStatus:804,status:804},{id:"contact",name:"배달완료",orderStatus:805,status:805}],activeTabIndex:0,bnum:1003,orderList:[]}},mounted(){const t=this.$route.query.status;t&&(this.activeTabIndex=t-1)},methods:{changeTab(t){this.activeTabIndex=t}},computed:{filteredOrders(){const t=Number(this.$route.query.status);return 800===t?this.orderList:this.orderList.filter((s=>s.ostatus_mikey===this.tabs[t-1].orderStatus&&s.bnum===this.bnum))}}};const ct=(0,q.A)(lt,[["render",c]]);var mt=ct}}]);
//# sourceMappingURL=390.25322777.js.map